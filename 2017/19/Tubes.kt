fun main(args: Array<String>) {
    val input = """                                                                                                       |
   +-+   +-+                                 +-+                   +---+       +-+   +-----------------|-----------------------------------+                                             +---+   +-+ +-+
   | |   | |                                 | |                   |   |       | |   |                 |                                   |                                             |   |   | | | |
   | +---+ +---------------------+           | |                   +-----------|-+   |                 |                                   |           +-------------------------------------|---|-+ | |
   |                             |           | |                       |       |     |                 |                                   |           |                                 |   |   |   | |
   |                       +-------------------------------------+ Y-+ | +-----|-----+                 |                                   |           |   +-----------------------------|---|---|-+ | |
   |                       |     |           | |                 |   | | |     |                       |                                   |           |   |                             |   |   | | | |
   +-----------------------|-----|-----------+ +-------------------+ +-+ |     +-----+         +-------------------------------------------|-----------|---|-----------------------------|---------|---+
                           |     |                               | |     |           |         |       |                                   |           |   |                             |   |   | | |
                           |     |                               | |     |           |         |       |   +---------------------------------+         |   |                             |   +---+ | |
                           |     |                               | |     |           |         |       |   |                               | |         |   |                             |         | |
                           |     |               +-----------------|-----|-----------|---------------------+                               | |         |   |           +-----------------|---+     | |
                           |     |               |               | |     |           |         |       |                                   | |         |   |           |                 |   |     | |
   +-------------+     +---|-----|-------------------------------|-|-----------------|-------+ |       |                                   +---------------|-----------|---------------------|-------|-+
   |             |     |   |     |               |               | |     |           |       | |       |                                     |         |   |           |                 |   |     | | |
 +-|-------------|-------+ |     |     +-----+   +---------------|---------------+   +-----+ | |     +---------------------------------------|-------------------+     |     +-----------|-+ |     | | |
 | |             |     | | |     |     |     |                   | |     |       |         | | |     | |                                     |         |   |     |     |     |           | | |     | | |
 | |             |     | | |     |     |     |                   | |     |       |         | +---------|-------------------------------------|-------------|-----------|-+   +-----------+ | |     | | |
 | |             |     | | |     |     |     |                   | |     |       |         |   |     | |                                     |         |   |     |     | |                 | |     | | |
 | |             |     | | |     |     |     |                   | |     |   +---|-------------|---------------------------------------------|---------|---|-----|-------|---------------+ | |     | | |
 | |             |     | | |     |     |     |                   | |     |   |   |         |   |     | |                                     |         |   |     |     | |               | | |     | | |
 | |     +---+   |     | | |     |     |     |                   | |     |   |   |         |   |     | +-------------------------------------|---------|---|-----------|-----------------|-|-|---------+
 | |     |   |   |     | | |     |     |     |                   | |     |   |   |         |   |     |                                       |         |   |     |     | |               | | |     | |
 | |     |   |   |     | | |     |   +---------------------------|---------------------------+ |     |                                       |         |   |     |     | |   +-+         | | |     | |
 | |     |   |   |     | | |     |   | |     |                   | |     |   |   |         | | |     |                                       |         |   |     |     | |   | |         | | |     | |
 | |     |   |   |     | | |     |   | |     |               +-----|---------|---|---------|-+ |     |                                       |         |   |     |     | |   | |         | | |   +---+
 | |     |   |   |     | | |     |   | |     |               |   | |     |   |   |         |   |     |                                       |         |   |     |     | |   | |         | | |   | |
 | |     |   |   |     | | |     | +---------------+     +-------+ |     |   |   |         |   |     |   +---------------------------------------+     |   |     |     | |   | |         | | +-+ | |
 | |     |   |   |     | | |     | | | |     |     |     |   |     |     |   |   O         |   |     |   |                                   |   |     |   |     |     | |   | |         | |   | | |
 | |     |   | +-------|-|-|-----|-+ | |     |     |     |   |     |     |   |   |         |   |     |   |                                   | +---------+ |     |     | |   | |         | |   | | |
 | |     |   | | |     | | |     |   | |     |     |     |   |     |     |   |   |         |   |     |   |                                   | | |     | | |     |     | |   | |         | |   | | |
 | |     |   | | |     | | +---------|-------|-----|---------|-----------|-------|---------|---|-----|---------------+                       | | |     | | |     |     | +---------+     | |   | | |
 | |     |   | | |     | |       |   | |     |     |     |   |     |     |   |   |         |   |     |   |           |                       | | |     | | |     |     |     | |   |     | |   | | |
 +-+     |   | | |     | |       | +-|-------------+     |   | +---|-----|---------------------|---------------------+                     +---|-------|-|-|-----|-----|-----|-|---|-----|-------+ |
         |   | | |     | |       | | | |     |           |   | |   |     |   |   |         |   |     |   |                                 | | | |     | | |     |     |     | |   |     | |   |   |
         |   | | |     | |       | | | |     |           |   | |   |     |   |   |         +---|---------|-----------------------------------+ | |     | | |     |     |     | |   |     | |   |   |
         |   | | |     | |       | | | |     |           |   | |   |     |   |   |             |     |   |                                 |   | |     | | |     |     |     | |   |     | |   |   |
         | +-----|-----|-------------|-|-------+         |   | |   |     |   |   |             |     |   |                                 | +-|-+     | | +-----|-----+   +-------------|-|-------+
         | | | | |     | |       | | | |     | |         |   | |   |     |   |   |             |     |   |                                 | | |       | |       |         | | |   |     | |   |
         | | | | |     | |       | | | |     | |         |   | |   |     |   |   |             |     |   |                                 | | |       | |       |         | | |   |     | |   | +-----+
         | | | | |     | |       | | | |     | |         |   | |   |     |   |   |             |     |   |                                 | | |       | |       |         | | |   |     | |   | |     |
   +-----|---|-|-------|-----------|-|-------|-|-------------|-|---|-----|---|-----------------|---------|---------------+                 | +-|-------|-|-------------------|-|---------------|-+     |
   |     | | | | |     | |       | | | |     | |         |   | |   |     |   |   |             |     |   |               |                 |   |       | |       |         | | |   |     | |   |       |
   |     | | | | |     | |       | | | |     | |         |   | |   |     |   |   |             |     |   |               +---------------------|-+     | |       |         | | |   |     +-|-----------+
   |     | | | | |     | |       | | | |     | |         |   | |   |     |   |   |             |     |   |                                 |   | |     | |       |         | | |   |       |   |
   |     | | | | |     | | +---------|-|-----|-+         |   | |   |     |   |   |             |     |   |                                 |   | |     | |       |         | | |   |     +---------+
   |     | | | | |     | | |     | | | |     |           |   | |   |     |   |   |             |     |   |                                 |   | |     | |       |         | | |   |     | |   |   |
   |     +---|-----------|-----+ | | | |     |           |   | |   |     |   |   |             |   +-|---|-------------+                   |   | | +-------+     |         | | |   |     | |   |   |
   |       | | | |     | | |   | | | | |     |           |   | |   |     |   |   |             |   | |   |             |                   |   | | |   | | |     |         | | |   |     | |   |   |
 +-----------|---|---------|---|-------|-----|-----------------|---|-------------|-------------|---------+       +-----|-------------------|-------------|------C|---+     | | | +-|-----|-+   |   |
 | |       | | | |     | | |   | | | | |     |           |   | |   |     |   |   |             |   | |           |     |                   |   | | |   | | |     |   |     | | | | |     |     |   |
 | | +-+ +-----|---------|-|---|-|-----+     |           |   | |   |     |   |   |             |   | |           |     |                   |   | | |   | | |     |   |     | | | | |     |   +-|---|---+
 | | | | | | | | |     | | |   | | | |       |           |   | |   |     |   |   |             |   | |           |     |                   |   | | |   | | |     |   |     | | | | |     |   | |   |   |
 | | | | | | | | | +-------|-----|---------+ |           |   | +---|-------------------------------|-|-------+   |     |                   |   | | |   | | |     |   |     | | | | |     |   | |   |   |
 | | | | | | | | | |   | | |   | | | |     | |           |   |     |     |   |   |             |   | |       |   |     |                   |   | | |   | | |     |   |     | | | | |     |   | |   |   |
 | | | | | | | | | |   | | |   | | | |     +-|-----------|---|-----|-----|-------|-------+     |   | |       |   |     |               +-----+ | | |   | | |     |   |     | | | | |     |   | |   |   |
 | | | | | | | | | |   | | |   | | | |       |           |   |     |     |   |   |       |     |   | |       |   |     |               |   | | | | |   | | |     |   |     | | | | |     |   | |   |   |
 | | | | | | +-|-|-----|-|-|---------|-------------------|---|-----|-----|-------|-------------|-------------|-------------------------|---|---|---------|-|-+   |   |     | | | | |     |   | |   |   |
 | | | | | |   | | |   | | |   | | | |       |           |   |     |     |   |   |       |     |   | |       |   |     |               |   | | | | |   | | | |   |   |     | | | | |     |   | |   |   |
 | | | | | |   | | +-+ | | |   | | | |     +-|---------------|-----|---------|---------------------|-|-----------|-------------------------|-|-|---|---|-|-|-|---|-+ |   +-|-+ | | |     |   | |   |   |
 | | | | | |   | |   | | | |   | | | |     | |           |   |     |     |   |   |       |     |   | |       |   |     |               |   | | | | |   | | | |   | | |   | |   | | |     |   | |   |   |
 | | | +-+ |   | |   | | | |   | | | |     | |           |   |     |     |   |   |       |     |   | |       |   |     |               |   | | | | |   | | | |   | | |   | |   | | |     |   | |   |   |
 | | |     |   | |   | | | |   | | | |     | |           |   |     |     |   |   |       |     |   | |       |   |     |               |   | | | | |   | | | |   | | |   | |   | | |     |   | |   |   |
 | | |   +-|-+ | |   | | | |   | +-|-|---+ | |           |   | +---|-----|---|---|-+     |     |   | |       |   |     |               |   | | | | |   | | | |   | | |   | |   | | |     |   | |   |   |
 | | |   | | | | |   | | | |   |   | |   | | |           |   | |   |     |   |   | |     |     |   | |       |   |     |               |   | | | | |   | | | |   | | |   | |   | | |     |   | |   |   |
 | +-----+ | +-------|-|-|-----|---|-|-----------------------------|-----|---|-------------------------------|---|-----|---------------|---|---|---|---|-+ | |   | | |   | |   | | |     |   | |   |   |
 |   |     |   | |   | | | |   |   | |   | | |           |   | |   |     |   |   | |     |     |   | |       |   |     |               |   | | | | |   |   | |   | | |   G |   | | |     |   | |   |   |
 +-+ |     |   | | +---------------|-|---|-|-|-----------|---|---------------|-----|---------------|---------|---------|---------------|-------|---|---|-----|---|-|-|---|---+ | +-------|-+ | |   |   |
   | |     |   | | | | | | |   |   | |   | | |           |   | |   |     |   |   | |     |     |   | |       |   |     |               |   | | | | |   |   | |   | | |   | | | |   |     | | | |   |   |
 +-|-----+ |   | | | | | | |   |   | |   | | |           |   | +-------------+   +-------------|---|---+     |   |     |               |   | | | | |   |   | |   | | +-----|-------|-------|-------|---+
 | | |   | |   | | | | | | |   |   | |   | | |           |   |     |     |         |     |     |   | | |     |   |     |               |   | | | | |   |   | |   | |     | | | |   |     | | | |   |
 | | | +-|-----|-----|---------|---|-------|-----------------------|-------------------------------|---------|---|-----|---------------|---|---|-----------------|---------|-|-----|-------------+ |
 | | | | | |   | | | | | | |   |   | |   | | |           |   |     |     |         |     |     |   | | |     |   |     |               |   | | | | |   |   | |   | |     | | | |   |     | | | | | |
 | | | | | +-----|-|-|-|-------|-----|-------|-----------|-----------+   |         |     |     |   | | |     |   |     |               |   | | | | |   |   | |   | |     | | | |   |     | | | | | |
 | | | | |     | | | | | | |   |   | |   | | |           |   |     | |   |         |     |     |   | | |     |   |     |               |   | | | | |   |   | |   | |     | | | |   |     | | | | | |
 | | | | |     | | | | | | |   |   | |   | | |           |   |     | |   |         |     |     |   | | |     |   |     |               |   | | | | |   |   | |   | |     | | | |   |     | | | | | |
 | | | | |     | | | | | | |   |   | |   | | |           |   |     | |   |         |     |     |   | | |     |   |     |               |   | | | | |   |   | |   | |     | | | |   |     | | | | | |
 | | | | |     | | | | | | |   |   | | +-|---|-----------------+ +-------|---------+     |     |   | | |     |   |     |           +-------+ | | | |   |   | |   | |     | | | |   |     | | | | | |
 | | | | |     | | | | | | |   |   | | | | | |           |   | | | | |   |               |     |   | | |     |   |     |           |   |     | | | |   |   | |   | |     | | | |   |     | | | | | |
 | | | | +---------|---+ | |   |   | | | | | |           |   | | | | |   |               |     |   | | |     |   |     |           |   |     | | | |   |   | |   | |     | | | |   |     | | | | | |
 | | | |       | | | |   | |   |   | | | | | |           |   | | | | |   |               |     |   | | |     |   |     |           |   |     | | | |   |   | |   | |     | | | |   |     | | | | | |
 | | | |       | | | |   | |   |   | | | +-|-------------|-----------+   |               |     |   | | |   +-|---------------------------------|-|-----|---|-|---|-------|-|-|-|---|---------|---------+
 | | | |       | | | |   | |   |   | | |   | |           |   | | | |     |               |     |   | | |   | |   |     |           |   |     | | | |   |   | |   | |     | | | |   |     | | | | | |   |
 | | +---------|---|-|---|-+ +-------|-|-----------------|-----|---------|---------------|-+   |   | | |   | |   |     |           |   |     | | | |   |   | |   | |     | | | |   |     | | | | | |   |
 | |   |       | | | |   |   | |   | | |   | |           |   | | | |     |               | |   |   | | |   | |   |     |           |   |     | | | |   |   | |   | |     | | | |   |     | | | | | |   |
 | +---|-----------|---+ | +-|-|---|-|-----|-------------|---|-|---------------------------|-------|-|---------------------------------|-----|---------+   | |   | |     | | | |   |     | | | +-------+
 |     |       | | | | | | | | |   | | |   | |           |   | | | |     |               | |   |   | | |   | |   |     |           |   |     | | | |       | |   | |     | | | |   |     | | |   | |
 |   +-+       | | | | | | | | | +-|---|-----|-----------|-----|---|---+ |               | |   |   | | |   | |   |     |           |   |     | | | |       | |   | |     | | | |   |     | | |   | +---+
 |   |         | | | | | | | | | | | | |   | |           |   | | | |   | |               | |   |   | | |   | |   |     |           |   |     | | | |       | |   | |     | | | |   |     | | |   |     |
 |   |         | | | | | | | | | | | | |   | |           |   | | | |   | |   +----K------|-------------------|---------------+     |   |     | | | |       | |   | |     | | | |   |     | | |   |     |
 |   |         | | | | | | | | | | | | |   | |           |   | | | |   | |   |           | |   |   | | |   | |   |     |     |     |   |     | | | |       | |   | |     | | | |   |     | | |   |     |
 |   |         | | | | | | | | | | | | |   | |           |   | | | | +-|-|---------------|-----------|-|-----|---------------------------------|-------------|-----------+ | | |   |     | | |   | +-+ |
 |   |         | | | | | | | | | | | | |   | |           |   | | | | | | |   |           | |   |   | | |   | |   |     |     |     |   |     | | | |       | |   | |       | | |   |     | | |   | | | |
 |   |         | | | | +---|---|---|---|---|-|-+         |   | | | | | | |   |           | |   |   | | |   | |   |     |     |     |   |     | | | |       | |   | | +-+   | | |   |     | | |   | | | |
 |   |         | | | |   | | | | | | | |   | | |         |   | | | | | | |   |           | |   |   | | |   | |   |     |     |     |   |     | | | |       | |   | | | |   | | |   |     | | |   | | | |
 |   |     +---|---------|---|---------|---|-------------|-------------------|-----+     | |   |   | | |   | |   |     |     |     |   |     | | | |       | |   | | | |   | | |   |     | | |   | | | |
 |   |     |   | | | |   | | | | | | | |   | | |         |   | | | | | | |   |     |     | |   |   | | |   | |   |     |     |     |   |     | | | |       | |   | | | |   | | |   |     | | |   | | | L
 |   |     |   | | | |   | | | | | | | |   | | |         |   | | | | +---|---|-----------|-----|---|-------|-|---|-----|-----|---------|-----|-----|-------|-|---|---|-|-----------|---+ | | | +-|-|-+ |
 |   |     |   | | | |   | | | | | | | |   | | |         |   | | | |   | |   |     |     | |   |   | | |   | |   |     |     |     |   |     | | | |       | |   | | | |   | | |   |   | | | | | | |   |
 |   |     |   | +---+ +-----|-----|-------|-------------|-----|-|-----------------|-----------|-----------|-|---|---------+ |     |   |     | | | |       | +---|-|---|---|-------+   | | | | | | |   |
 |   |     |   |   |   | | | | | | | | |   | | |         |   | | | |   | |   |     |     | |   |   | | |   | |   |     |   | |     |   |     | | | |       |     | | | |   | | |       | | | | | | |   |
 |   |     |   |   |   | | | | | | | | |   | | |         |   | | | |   | |   | +-----------|---|---|-|-----|-|---------|-----------|---|-------|-|---------|---------|-|---------------+ | +-|-+ | |   |
 |   |     |   |   |   | | | | | | | | |   | | |         |   | | | |   | |   | |   |     | |   |   | | |   | |   |     |   | |     |   |     | | | |       |     | | | |   | | |         |   |   | |   |
 | +-|-------------|---|-|---|-|---|-|-|---|-|-|-----------------|-----|-----------|-----|-----------------|-----------|-----|---------------|-|-|---------|-----|-|-|-------|-|-------+ |   |   | |   |
 | | |     |   |   |   | | | | | | | | |   | | |         |   | | | |   | |   | |   |     | |   |   | | |   | |   |     |   | |     |   |     | | | |       |     | | | |   | | |       | |   |   | |   |
 | | +-----|-----------|-------|---|-|---------|---------|-----|-|-------|-----------------|---|---|---------+   |     |   | |     |   |     | | | |       |     | | | |   | | |       | |   |   | |   |
 | |       |   |   |   | | | | | | | | |   | | |         |   | | | |   | |   | |   |     | |   |   | | |   |     |     |   | |     |   |     | | | |       |     | | | |   | | |       | |   |   | |   |
 | |       |   +---|---|-----|-+ | | | |   | | +-----------------------|-----|-------------------------|---------------|---------------|-----|-|-+ |       |     | | | |   | | |       | |   |   | |   |
 | |       |       |   | | | |   | | | |   | |           |   | | | |   | |   | |   |     | |   |   | | |   |     |     |   | |     |   |     | |   |       |     | | | |   | | |       | |   |   | |   |
 | |       |       |   +-|-|-|---|-|---------|-----------|-------|-----|-----|---------------+ |   | | |   |     +-----------|-----|---|---+ | |   +---------+   | | | |   | | |       | |   |   | |   |
 | |       |       |     | | |   | | | |   | |           |   | | | |   | |   | |   |     | | | |   | | |   |           |   | |     |   |   | | |           | |   | | | |   | | |       | |   |   | |   |
 | |       |       |     | | |   | | | |   | |           |   | | | |   | | +-|-|---|-----------|-----------+           |   | |     |   |   | | |           | |   | | | |   | | |       | |   |   | |   |
 | |       |       |     | | |   | | | |   | |           |   | | | |   | | | | |   |     | | | |   | | |               |   | |     |   |   | | |           | |   | | | |   | | |       | |   |   | |   |
 | |       |       |     | | |   | | | |   | |           |   | | | |   | | | | |   |     | | | |   | | |               |   | |     |   |   | | |           | |   | | | |   | | |       | |   |   | |   |
 | |       |       |     | | |   | | | |   | |           |   | | | |   | | | | |   |     | | | |   | | |               |   | |     |   |   | | |           | |   | | | |   | | |       | |   |   | |   |
 | |       |       |     | | |   | | | |   | |           |   | | | |   | | | | |   |     | | | |   | | |               |   | |     |   |   | | |           | |   | | | |   | | |       | |   |   | |   |
 | |       |       |     | | |   | | | |   | |           |   | | | |   | | | | |   |     | | | |   | | |               |   | |     |   |   | | |           | |   | | | |   | | |       | |   |   | |   |
 | |       |       |   +---------+ | | |   | | +---------|-------+ |   | | | | |   |     | | | |   | | |               |   | |     |   |   | | |           | |   | | | |   | | |       | |   |   | |   |
 | |       |       |   | | | |     | | |   | | |         |   | |   |   | | | | |   |     | | | |   | | |               |   | |     |   |   | | |           | |   | | | |   | | |       | |   |   | |   |
 | |       |       |   | | | | +---|---|---|-----------------|-|-------|-------|---|-----------|---|---+               |   | |     |   |   | | |           | |   | | | |   | | |       | |   |   | |   |
 | |       |       |   | | | | |   | | |   | | |         |   | |   |   | | | | |   |     | | | |   | |                 |   | |     |   |   | | |           | |   | | | |   | | |       | |   |   | |   |
 | |       |       |   | | | | |   | | |   | | |         |   | |   |   | | | | |   |     | | | |   | |                 |   | |     |   |   | | |           | |   | | | |   | | |       | |   |   | |   |
 | |       |       |   | | | | |   | | |   | | |         |   | |   |   | | | | |   |     | | | |   | |                 |   | |     |   |   | | |           | |   | | | |   | | |       | |   |   | |   |
 | |       |       |   | | | | |   | | |   | | |         |   | |   | +---|-----|---------|-|-|-|---|-------------------|-----------|-------|-----------------|-----|---------|-+       | |   |   | |   |
 | |       |       |   | | | | |   | | |   | | |         |   | |   | | | | | | |   |     | | | |   | |                 |   | |     |   |   | | |           | |   | | | |   | |         | |   |   | |   |
 | +-+     |       |   +-|---------|---|-----|-|---------|---|-|-----------|-|-|---------|-+ | |   | |                 |   | |     +---|-----+ |           | |   | | | | +-|---+       | |   |   | |   |
 |   |     |       |     | | | |   | | |   | | |         |   | |   | | | | | | |   |     |   | |   | |                 |   | |         |   |   |           | |   | | | | | | | |       | |   |   | |   |
 |   |     |       |     | | | |   | | |   | | |         |   | |   | | | | | | |   |     |   | |   | |                 |   | |         +---|-----------------|-----------|-|---|-------|-----|-----|---+
 |   |     |       |     | | | |   | | |   | | |         |   | |   | | | | | | |   |     |   | |   | |                 |   | |             |   |           | |   | | | | | | | |       | |   |   | |
 | +-----+ |       |     | +---------------------+       |   | |   +---|---|-|-----------|---|-|---|-|-----------------------|-------------|---------------|---------|-|-|-|---+       | |   |   | |
 | | |   | |       |     |   | |   | | |   | | | |       |   | |     | | | | | |   |     |   | |   | |                 |   | |             |   |           | |   | | | | | | |         | |   |   | |
 | | |   | |       |     |   | |   | | |   | | | |       |   | |     | | | | | |   |     |   | |   | |                 |   | |             |   |           | |   | | | | | | |         | |   |   | |
 | | |   | |       |     |   | |   | | |   | | | |       |   | |     | | | | | |   |     |   | |   | |                 |   | |             |   |           | |   | | | | | | |         | |   |   | |
 | | |   | |       |     |   | |   | | |   | | | |       |   +-------------|-|-|---|---------|-|-----|-----------+     |   | |             |   |           | |   | | | | | | |         | |   |   | |
 | | |   | |       |     |   | |   | | |   | | | |       |     |     | | | | | |   |     |   | |   | |           |     |   | |             |   |           | |   | | | | | | |         | |   |   | |
 | +-------|-------|-----|---|-----|-|-----|-+ | |       | +---|---+ | | | | +-|---------|---|---+ | |           |     |   | |             |   |           | |   | | | | | | |         | |   |   | |
 |   |   | |       |     |   | |   | | |   |   | |       | |   |   | | | | |   |   |     |   | | | | |           |     |   | |             |   |           | |   | | | | | | |         | |   |   | |
 |   |   | |       |     |   | |   | | |   |   | |       | |   |   | | | | |   |   |     |   | | | | |           |     |   | |             |   |           | |   | | | | | | |         | |   |   | |
 |   |   | |       |     |   | |   | | |   |   | |       | |   |   | | | | |   |   |     |   | | | | |           |     |   | |             |   |           | |   | | | | | | |         | |   |   | |
 |   |   | |       |     |   | |   | | |   |   | |       | |   |   | | | | |   |   |     |   | | | | |           |     |   | |             |   |           | |   | | | | | | |         | |   |   | |
 |   |   | |       |     |   | |   | | |   |   | |       | |   |   | | | | |   |   |     |   | | | | |           |     |   | |             |   |           | |   | | | | | | |         | |   |   | |
 |   |   | |       |     |   | +---|---|---|---|-|-------------|---------|-----|---|-----|---|-----|-|-----------|---------|-------+       |   |           | |   | | | | | | |         | |   |   | |
 |   |   | |       |     |   |     | | |   |   | |       | |   |   | | | | |   |   |     |   | | | | |           |     |   | |     |       |   |           | |   | | | | | | |         | |   |   | |
 |   |   +-------+ |     |   |     | | |   |   | +-------|-|---|---|---|---|---|---------|-----|-|---|-------------+   |   | +-----|-------|---|-+   +-----|-------|-----+ | |         | |   |   | |
 |   |     |     | |     |   |     | | |   |   |         | |   |   | | | | |   |   |     |   | | | | |           | |   |   |       |       |   | |   |     | |   | | | |   | |         | |   |   | |
 |   |     |     | |     |   |     | | |   |   |         | |   |   | | | | |   |   |     |   | | | | |           | |   |   | +-----+       |   | +---|-+   | |   | +-|-|---------------|-+   |   | |
 |   |     |     | |     |   |     | | |   |   |         | |   |   | | | | |   |   |     |   | | | | |           | |   |   | |             |   |     | |   | |   |   | |   | |         |     |   | |
 |   |     |     | |     |   |     | | |   |   |         | |   |   | | | | |   |   |     |   | | | | |           | |   |   | |             |   |     +-|---|-|---|---|-------|-----+   |     |   | |
 |   |     |     | |     |   |     | | |   |   |         | |   |   | | | | |   |   |     |   | | | | |           | |   |   | |             |   |       |   | |   |   | |   | |     |   |     |   | |
 |   |     |   +-|-|---------|-------|-------------------------------------|---|-----------------------------------|---|---|-|-------------------------|---|---------|-----|-|-----|---|---------|-|---+
 |   |     |   | | |     |   |     | | |   |   |         | |   |   | | | | |   |   |     |   | | | | |           | |   |   | |             |   |       |   | |   |   | |   | |     |   |     |   | |   |
 |   |     |   | | |     +---------|---|-------------------|---------------|---|---------|-----|-------------------|-------|---------------------------|-----|---|---|-|---------+ |   |     |   | |   |
 |   |     |   | | |         |     | | |   |   |         | |   |   | | | | |   |   |     |   | | | | |           | |   |   | |             |   |       |   | |   |   | |   | |   | |   |     |   | |   |
 |   |     |   | | |         |     | | |   |   |         | | +-----------------|---|-----|---|-----|-|-----------|-----|-----+             |   |       |   | |   |   | |   | |   | |   |     |   | |   |
 |   |     |   | | |         |     | | |   |   |         | | | |   | | | | |   |   |     |   | | | | |           | |   |   |               |   |       |   | |   |   | |   | |   | |   |     |   | |   |
 |   |     |   | +-|-----+   |     | | |   |   |         | | | |   | | | | |   |   |   +-----|-|-----|-------------|---|-----------------------------------|-|-+ |   | |   | |   | |   |     |   | |   |
 |   |     |   |   |     |   |     | | |   |   |         | | | |   | | | | |   |   |   | |   | | | | |           | |   |   |               |   |       |   | | | |   | |   | |   | |   |     |   | |   |
 |   |     |   | +-|-----+   |     +-------|---|-----------|-|---------|---|---+   |   | |   | | | | |           | |   |   |               |   |       |   | | +-|-----|---|-|-------+ |     |   | |   |
 |   |     |   | | |         |       | |   |   |         | | | |   | | | | |       |   | |   | | | | |           | |   |   |               |   |       |   | |   |   | |   | |   | | | |     |   | |   |
 +---|---------|---|-----------------|-----|---|---------|-|-|-----|---|-----------------|---+ | | | |           | |   |   |               |   |       |   | |   |   | |   | |   | | | |     |   | |   |
     |     |   | | |         |       | |   |   |         | | | |   | | | | |       |   | |     | | | |           | |   |   |               |   |       |   | |   |   | |   | |   | | | |     |   | |   |
     |     |   | | |         |       | |   |   |         | | | |   | | | | |       |   | |     | | | |           | |   |   |               |   |       |   | |   |   | |   | |   | +-|-|-----|---|---+ |
     |     X   | | |         |       | |   |   |         | | | |   | | | | |       |   | |     | | | |           | |   |   |               |   |       |   | |   |   | |   | |   |   | |     |   | | | |
     |     |   | | |         |       | |   |   |         | | | +-----|-|---|-------+   | |     | | | |           | |   |   |               |   |   +---+   | |   |   | |   | |   |   | |     |   | | | |
     |     |   | | |         |       | |   |   |         | | |     | | | | |           | |     | | | |           | |   |   |               |   |   |       | |   |   | |   | |   |   | |     |   | | | |
     |     |   | +-|-----------------|-------------------|-|-------|---|A|-|---+       | |     | +---|-----------|-|---|---|---------------|---|---|-------|-|-+ |   | |   | |   |   | |     |   | | +-+
     |     |   |   |         |       | |   |   |         | | |     | | | | |   |       | |     |   | |           | |   |   |               |   |   |       | | | |   | |   | |   |   | |     |   | |
     |     |   | +---------------------|---------------------|-------|-|---+   |       | |     |   | |           | |   |   |               +---------------|-+ | +---|-|---|-----|-----|-----|-----|-+
     |     |   | | |         |       | |   |   |         | | |     | | | |     |       | |     |   | |           | |   |   |                   |   |       |   |     | |   | |   |   | |     |   | | |
     |     |   | | |         | +-----|-----|-----------------------------|---------------|-----|-----|-------------|---|-----------------------|---|-------|---|---+ | +---+ +---|---|-|---+ |   | | |
     |     |   | | |         | |     | |   |   |         | | |     | | | |     |       | |     |   | |           | |   |   |                   |   |       |   |   | |           |   | |   | |   | | |
     |     |   | | |         | +-----------|-------------|-+ +-+   +-|-|-------+       | |     |   | |           | |   |   |                   |   |       |   |   | |       +---|-----|-+ | |   | | |
     |     |   | | |         |       | |   |   |         |     |     | | |             | |     |   | |           | |   |   |                   |   |       |   |   | |       |   |   | | | | |   | | |
     |     |   | +-|---------|-------|-------------------------------|-|-----------------------|-----|-----------|-|---|---|-----------------------|-------|-------|-----+   +-----+ | | | | |   | | |
     |     |   |   |         |       | |   |   |         |     |     | | |             | |     |   | |           | |   |   |                   |   |       |   |   | |   |       | | | | | | |   | | |
     |     |   |   |         | +-----|-|-------|---------|-----|---------|---------------|-----+   | |           | |   |   |                   |   |   +---|-+ |   | |   |       | | | | +-------|-+ |
     |     |   |   |         | |     | |   |   |         |     |     | | |             | |         | |           | |   |   |                   |   |   |   | | |   | |   |       | | | |   | |   |   |
     |     |   |   |         | | +---------|---|---------------------|---|-------------------------+ |           | |   |   | +-----------------|---|---|---|-+ | +-|---+ |   +-+ | | | |   | |   |   |
     |     |   |   |         | | |   | |   |   |         |     |     | | |             | |           |           | |   |   | |                 |   |   |   |   | | | | | |   | | | | | |   | |   |   |
     |     |   |   |         | | |   | |   |   |         |     |     | | |             +-|-----------|-----------------|---------------------------|---|---|-+ +---|-|-|-+   +---+ | +-------|---|---|-+
     |     |   |   |         | | |   | |   |   |         |     |     | | |               |           |           | |   |   | |                 |   |   |   | |   | | | |       |   |   |   | |   |   | |
     |     |   |   |         | | +-+ +-----|---|---------------|---------|---------------|-----+     +-----------+ +-------|-----------------------|---+   | |   | | | +---+   |   |   | +---|---+   | |
     |     |   |   W         | |   |   |   |   |         |     |     | | |               |     |                       |   | |                 |   |       | |   | | |     |   |   |   | | | |       | |
   +-------|---|---|---------|-|-----------|-------------------|-------|-----------------|-----|-----------------------|---|-|-----------------|-------------|---|---|-------------|---+ | | |       | |
   | |     |   |   |         | |   |   |   |   |         |     |     | | |               |     |                       |   | |                 |   |       | |   | | |     |   |   |     | | |       | |
   | |     +-----------------|-|---|-------|-------------+     |     | | |               |     |                       |   | |           +-----|-----------------|-|------R|---|---+     | | |       | |
   | |         |   |         | |   |   |   |   |               |     | | |               |     |                       |   | |           |     |   |       | |   | | |     |   |         | | |       | |
   | +-------------|---------+ |   |   |   +---|---------------|-------|-+               +-----------------------------|-----+           |     |   +-+     | |   | | |     +---+         | +-|-+     | |
   |           |   |           |   |   |       |               |     | |                       |                       |   |             |     |     |     | |   | | |                   |   | |     | |
 +-+           +-----------------------------------------------|-----|-----------------+       |                       |   +-+           |     |     |     +-+   | | | +-----------------|-------------+
 |                 |           |   |   |       |               |     | |               |       |                       |     |           |     |     |           | | | |                 |   | |     |
 +-----------------------------|-------|-------|---------------------------------------|-------|-----------------------|-----|-----------|-----|-----------------|-----|---------------+ |   | |     |
                   |           |   |   |       |               |     | |               |       |                       |     |           |     |     |           | | | |               | |   | |     |
                   |           +---|-----------|-----------------------|---------------|-------|-----------------------|-----------------------------|-------------|-|-|---------------|-+   | |     |
                   |               |   |       |               |     | |               |       |                       |     |           |     |     |           | | | |               |     | |     |
                   |               |   |       |               +-----|-|---------------+       |                       +-----------------------------|-----------|-|-|-----------------|-------------+
                   |               |   |       |                     | |                       |                             |           |     |     |           | | | |               |     | |
                   |               |   |       +---------------------+ +-----------------------|-----------------------------|-----------------|---------------------|-----------------|-------+
                   |               |   |                                                       |                             |           |     |     |           | | | |               |     |
                   +---------------+   +-------------------------------------------------------+                             +-----------+     +-----+           +-+ +-+               +-----+

"""

    var result = ""
    val inputAs2dArray = input.split('\n').map { it.split("") }
    var direction = Direction.DOWN
    val pos = Position(inputAs2dArray[0].indexOf("|"), 0)
    var currentElement = "|"
    var numSteps = 0

    while (currentElement != " "){
        numSteps++;
        println(currentElement)
        when(direction){
            Direction.DOWN -> pos.moveDown()
            Direction.LEFT -> pos.moveLeft()
            Direction.UP -> pos.moveUp()
            Direction.RIGHT -> pos.moveRight()
        }

        currentElement = inputAs2dArray[pos.y][pos.x]
        if(currentElement.matches(Regex("\\w"))) {
            result += currentElement
        }
        else if (currentElement == "+"){
            direction = if(direction != Direction.UP &&
                            !inputAs2dArray.getOrNull(pos.y + 1)?.getOrNull(pos.x).isNullOrBlank()) Direction.DOWN
                        else if(direction != Direction.DOWN &&
                            !inputAs2dArray.getOrNull(pos.y - 1)?.getOrNull(pos.x).isNullOrBlank()) Direction.UP
                        else if(direction != Direction.LEFT &&
                            !inputAs2dArray.getOrNull(pos.y)?.getOrNull(pos.x + 1).isNullOrBlank()) Direction.RIGHT
                        else Direction.LEFT
        }
    }

    println(result)
    println(numSteps)
}

data class Position(var x: Int, var y: Int){
    fun moveUp() = y--
    fun moveDown() = y++
    fun moveLeft() = x--
    fun moveRight() = x++
}

enum class Direction {
    UP,
    DOWN,
    LEFT,
    RIGHT
}